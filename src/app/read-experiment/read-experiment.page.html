<!-- 
  Copyright © 2020, Raytheon BBN Technologies. All rights reserved.
  See LICENSE.md in top level directory for additional information
 -->

<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button routerLink="/home" routerDirection="root">
        <ion-icon slot="icon-only" name="arrow-back"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Experiment Details</ion-title>
    <!-- <ion-buttons slot="primary" (click)="share()">
      <ion-button>
        <ion-icon slot="icon-only" slot="end" name="share-social"></ion-icon>
      </ion-button>
    </ion-buttons> -->
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding" *ngIf="experiment != null">
  <ion-card>
    <ion-card-header>
      <ion-card-title>Does the data look good?</ion-card-title>
    </ion-card-header>
  
    <ion-card-content>
      Export this data for researchers to use in developing effective Bluetooth contact tracing algorithms
      <br/><br/>
      <ion-button color="success" expand="block" (click)="openExportModal()">
       Export Now
     </ion-button>
    </ion-card-content>

   
  </ion-card>

  <ion-list>
    <ion-item-group>
      <ion-item-divider>
        <ion-label>Experiment</ion-label>
      </ion-item-divider>
      <ion-item>
        <ion-note slot="start">Title</ion-note>
        <ion-label align="right">{{ experiment.title }}</ion-label>
      </ion-item>
      <ion-item>
        <ion-note slot="start">Description</ion-note>
        <ion-label class="ion-text-wrap" align="right">{{ experiment.note }}</ion-label>
      </ion-item>
      <ion-item>
        <ion-note slot="start">Experiment ID</ion-note>
        <ion-label class="ion-text-wrap" align="right">{{ experiment.experimentUUID }}</ion-label>
      </ion-item>
    </ion-item-group>

    <ion-item-group>
      <ion-item-divider>
        <ion-label>Settings</ion-label>
      </ion-item-divider>
      <ion-item>
        <ion-note slot="start">Distance</ion-note>
        <ion-label align="right">{{ experiment.distance }} meters</ion-label>
      </ion-item>
      <ion-item>
        <ion-note slot="start">Orientation, Device 1</ion-note>
        <ion-label align="right">{{ experiment.orientation1 }}°</ion-label>
      </ion-item>
      <ion-item>
        <ion-note slot="start">Orientation, Device 2</ion-note>
        <ion-label align="right">{{ experiment.orientation2 }}°</ion-label>
      </ion-item>
    </ion-item-group>

    <ion-item-group>
      <ion-item-divider>
        <ion-label>Device</ion-label>
      </ion-item-divider>
      <ion-item>
        <ion-note slot="start">Manufacturer</ion-note>
        <ion-label align="right">{{ experiment.device.manufacturer }}</ion-label>
      </ion-item>
      <ion-item>
        <ion-note slot="start">Model</ion-note>
        <ion-label align="right">{{ experiment.device.model }}</ion-label>
      </ion-item>
      <ion-item>
        <ion-note slot="start">Serial</ion-note>
        <ion-label align="right">{{ experiment.device.serial }}</ion-label>
      </ion-item>
      <ion-item>
        <ion-note slot="start">Version</ion-note>
        <ion-label align="right">{{ experiment.device.version }}</ion-label>
      </ion-item>
    </ion-item-group>

    <ion-item-group>
      <ion-item-divider>
        <ion-label>Data</ion-label>
      </ion-item-divider>
      <!-- <ion-item>
        <pre>
          {{ experiment.data | json }}
        </pre>
      </ion-item> -->

      <ion-row style="border-bottom: groove;">
        <ion-col col-4>
          <ion-label>timestamp</ion-label>
        </ion-col>
        <ion-col col-4>
          <ion-label>address</ion-label>
        </ion-col>
        <ion-col col-4>
          <ion-label>rssi</ion-label>
        </ion-col>
      </ion-row>
      <ion-row style="border-bottom: groove;" *ngFor="let data of experiment.data">
        <ion-col col-4>
          <ion-label>{{ data.timestamp }}</ion-label>
        </ion-col>
        <ion-col col-4>
          <ion-label>{{ data.address }}</ion-label>
        </ion-col>
        <ion-col col-4>
          <ion-label>{{ data.rssi }}</ion-label>
        </ion-col>
      </ion-row>
    </ion-item-group>
  </ion-list>

  <ion-button size="small" color="danger" (click)="deleteExperiment()">Delete Experiment</ion-button>
</ion-content>